---
layout: post
title: 如何借得10亿Yahoo邮箱账户
---
很简单，只要三步：

1. 找到Yahoo员工。这个很简单，到Facebook，LinkedIn等社交网站，一找一大堆。从中可以找到这个员工的工作岗位。还可以从各种途径找到工作邮箱。

2. 控制Yahoo的服务器。可以选择的途径有鱼叉式网络钓鱼（Spear phishing）。鱼叉式网络钓鱼是一种针对性很强的网络钓鱼方法，基本思路是给目标雇员发跟他／她相关的钓鱼邮件，让目标相信这是真的，比如：
  * 给流程工程师发一份来自自动化合作伙伴或者供应商的电子邮件通知；
  * 给财务分析师发带有当前项目数据的电子邮件表格；
  * 给经理发一个关于竞争对手收购活动的网站链接。

  因为我们已经有Yahoo员工的邮箱，典型的方法是给这些员工发钓鱼邮件，想办法让他打开一份被感染的PDF文件、文档文件、表格、Java应用或者网站。一旦打开，就可以下载恶意软件，利用操作系统的漏洞，安装后门，达到控制机器的目的。有的时候，网络钓鱼是为了欺骗对方，让对方在钓鱼网站上主动提供帐号登录信息

3. 通过后门或所获得的帐号登录信息，访问Yahoo内部网络的服务器，找到用户数据库和帐户管理工具。

用户数据库通常包含以下信息：账户用户名；备用邮箱帐号和电话号码，一般，如果Yahoo邮箱不能使用，邮件就会发给备用邮箱，比如，如果你要求重置邮箱密码，重置的链接就会发到备份邮箱；密码问题和答案，通常，如果用户需要重置密码或其它敏感信息，Yahoo会问这些问题；还有跟帐号相关的加密信息，例如帐号的“随机数（nonce）”等。注意：这里面没有邮箱用户密码。
帐户管理工具可以访问和管理存储在用户数据库中的信息，比如，更改，记录，追踪帐号的变化，包括密码的变化。 

没有密码怎么访问用户邮箱？没关系，我们可以借助用户数据库中的帐号随机数。帐号随机数是一长串数字，能唯一标示一个用户。它可以干什么用呢？这跟帐户登录和验证有关系。在用户登录邮箱时，用户与服务器之间有很多交互，涉及非常复杂的协议。如下图1所示：

![_config.yml]({{ site.baseurl }}/images/cookie-1.png)

因为登录过程很复杂，为了减轻服务器的负担，也为了提高用户体验，服务器在用户验证通过后，会给一个信物，在以后一段时间内，靠这个信物就可以直接访问邮箱而不需要再次输入用户名和密码了（没有哪个用户愿意为看个邮件，结果要输入n次用户名和密码不是？）。用互联网的术语，这个信物叫浏览器缓存（英文是cookie，直译过来就是曲奇饼）。曲奇饼中存有信息来标示这个客户已经通过验证。具体在曲奇饼中存什么信息，怎么存是由服务器定义的。因为控制了Yahoo服务器，所以知道了Yahoo邮箱服务器是如何构建这些曲奇饼的。Yahoo的曲奇饼中包含帐号随机数，而帐号随机数存在用户数据库中，所以，有了用户数据库，有了曲奇饼构建方法，再在互联网上找一个曲奇饼构建软件，什么都有了。有了Yahoo邮箱的曲奇饼就可以直接跳到图1的“我想访问邮箱，这是我的曲奇饼”这一步。服务器接到这个请求，检查曲奇饼，一切正常，就立马把邮箱里的邮件发过来了如下图2所示：

![_config.yml]({{ site.baseurl }}/images/cookie-2.png)

数以亿计的用户的数据库一般很大，里面有很多信息，可以慢慢挖掘。通常的做法是拷贝一份用户数据库，通过FTP（一种古老而简单的计算机之间传送文件的协议）或其它方法将文件送到自己的服务器上慢慢看。
有人会说，这不是偷吗？“读书人的事，能算偷么？”，孔乙己说的，所以这里说“借”。
借来邮箱可以干什么：大数据挖掘啊！
1. 访问商业公司雇员的邮箱以获得商业机密，包括：云存储公司雇员，邮箱服务商雇员，金融公司雇员，赌博公司，航空公司，私募基金，
2. 修改Yahoo搜索结果，将网络流量引到卖壮阳药的厂家网站，以获得佣金
3. 寻找存在邮箱里的信用卡，礼品卡，等其它可以变现的信息
4. 获得这些用户的通讯录，发垃圾邮件赚钱
5. 获得存在邮箱的其它邮箱（比如Google，Apple）的地址和密码
6. 通过入侵目标人群的亲属的邮箱，比如配偶和子女，来获得目标人群的有关信息

如何避免执法机构找麻烦：
1. 狡兔三窟，租用多个国家的服务器的虚拟私有网（VPN），这样可以隐藏行踪，避免被执法机构和受害者发觉
2. 在多个国家的邮件服务商注册邮箱地址，注意不要用你的真名实姓和你家地址，免得警察顺藤摸瓜
3. 别忘了装日志清洁器。服务器的日志记录了机器上的日常活动，比如谁登录了，做了什么操作等。日志清洁器可以抹去你不想要留下的痕迹，使得别人不能追踪你
4. 最好与你所在国的相关国家机构合作，比如，你要是在俄国，就跟俄国联邦安全局（FSB）合作，经常帮FSB做点它不做的事。 窃取FSB感兴趣的特定人群邮箱内容，包括政府官员，记者，外交官，公共事务研究机构。这样，如果美国FBI找你的麻烦，FSB可以提供保护伞。

再狡猾的狐狸也斗不过好猎手。虽然采用了多种办法藏匿行踪，但狐狸总会露出尾巴。比如，上面我们说到的帐号随机数，它可以被用于生成曲奇饼，来访问别人的邮箱，但是，这个随机数在用户修改密码后就会变。如果有人继续使用原来的随机数生成的曲奇饼来访问修改密码后的邮箱，服务器就会发现这个异常，然后记录下来，成为未来追查的依据。真所谓“成也萧何，败也萧何”。

借用邮箱有风险，如果不小心被抓了，你可能会被以多项罪名起诉。以下是罪名和最高可能坐牢的时间。
1. 阴谋实施计算机欺诈和滥用罪。最高10年
2. 阴谋从事经济间谍活动罪。最高15年
3. 阴谋盗窃商业机密罪。最高10年
4. 经济间谍罪。最高15年（每一项）
5. 盗窃商业机密罪。最高10年（每一项）
6. 阴谋实施电话欺诈罪。最高20年
7. 访问（或试图访问）未授权的计算机以获取信息，为商业或个人经济利益服务罪。 最高5年（每一项）
8. 以损害计算机为目的，传输代码到计算机罪. 最高10年（每一项）
9. 伪造访问设备欺诈罪。最高10年（每一项）
10. 伪造访问设备制造罪。最高15年
11. 阴谋实施访问设备欺诈罪。最高7.5年
12. 阴谋实施网络欺诈罪。最高20年
13. 严重身份盗窃罪t。最高2年

警告：以上部分内容，在北加州起诉Dmitry Aleksandrovich Dokuchaev,; Igor Anatolyevich Sushchin, Alexsey Alexseyevich Belan，和Karim Baratov 的起诉书里可以找到。这里描述的方法可以在你家中机器尝试，不要用于别人的机器。

另外，Yahoo承认有超过10亿帐号被盗。上述起诉书里涉及5亿帐号。另外5亿帐号可能是由其他黑客侵入造成的。

参考文献：

1. https://www.justice.gov/opa/press-release/file/948201/download
2. http://baike.baidu.com/item/%E9%B1%BC%E5%8F%89%E5%BC%8F%E7%BD%91%E7%BB%9C%E9%92%93%E9%B1%BC/16763869?fr=aladdin
3. https://www.justice.gov/opa/pr/us-charges-russian-fsb-officers-and-their-criminal-conspirators-hacking-yahoo-and-millions

